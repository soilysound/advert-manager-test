// FINGERPRINT-JS.JS
// ===================

// get dependencies
var fs = require('fs-extra');
var path = require('path');
var yaml = require('node-yaml');

// path consts
var ROOT = path.resolve(process.cwd());
var relativeFingerprintsFile = process.env.npm_package_config_fingerprints_path || '/app/config/fingerprints.yml';
var FINGERPRINT_FILE = ROOT + relativeFingerprintsFile;
var JS_MIN_FILES = ROOT + '/web/js/min/*.{js,map}';
var JS_REQUIRE_FILE = ROOT + '/web/require-config-min*';
var CSS_MIN_FILES = ROOT + '/web/css/min/*.{css,map}';

// Reset fingerprints.yml
var defaultFingerPrintConfig = {
    'parameters': {
        'sdc.fingerprints': {}
    }
};

yaml.write(FINGERPRINT_FILE, defaultFingerPrintConfig, 'utf8', function(error){
    if (error) throw error;
});

// Delete JS min files
fs.removeSync(JS_MIN_FILES);
fs.removeSync(JS_REQUIRE_FILE);

// Delete CSS min files
fs.removeSync(CSS_MIN_FILES);
