// Use css animations to listen for dom changes that indicate a fireplace takeover advert is running and apply the advert--site-takeover class automatically
define('component-loader', [], function () {

  "use strict";

  return {
    // try various selectors that would match if a fireplace style takeover ad is running
    cssSelector: 'body[style*="background"],[name*="InSkin"],[id*="InSkin"]',

    // add '.advert--site-takeover' to the body
    // full-width components can use this to avoid clashing with the ad creative
    init: function(){
      ['animationstart', 'webkitAnimationStart'].forEach(function(eventName){
        document.addEventListener(eventName, function(event){
          if(event.animationName === 'ad-takeover'){
            document.body.classList.add('advert--site-takeover');
          }
        })
      })

      this.initCss();
    },

    initCss: function(){
      //trigger loader by adding css to dom
      var style = document.createElement('style');

      style.textContent = [
        "@-webkit-keyframes ad-takeover {0%{outline:0}100%{outline:0 solid red}}",
        "@keyframes ad-takeover {0%{outline:0}100%{outline:0 solid red}}",
        this.cssSelector,
        "{-webkit-animation: ad-takeover 0.01s;animation: component-loader 0.01s}"
      ].join('');

      document.querySelector('head').appendChild(style);
    }
  }

});
